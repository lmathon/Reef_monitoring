select(Longitude,Latitude)
pts <- metadata_dist %>%
dplyr::select(Longitude,Latitude)
# calculate and formate distance
dist <- gDistance(pts_sp2, coast, byid = T)
library(rgeos)
# calculate and formate distance
dist <- gDistance(pts_sp2, coast, byid = T)
dist_min <- apply(dist,2,min)
dist_min <- round(dist_min, 0)
metadata_dist$dist_to_coast <- dist_min
View(metadata_dist)
GCRMN_meta <- left_join(GCRMN_meta, metadata_dist[,c("Site_ID","dist_to_coast")])
View(GCRMN_meta)
write.csv(GCRMN_meta, file="c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", row.names = F)
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Site_biodiversity_metrics.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "")
View(meta)
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
View(meta)
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Site_biodiv$Year <- as.factor(Site_biodiv$Year)
View(Site_biodiv)
Site_biodiv <- left_join(meta[,c("Site_ID", "Protection")], Site_biodiv)
Site_biodiv <- Site_biodiv%>%
filter(!is.na(Site)) %>%
distinct(Site_ID, .keep_all=T)
Site_biodiv <- left_join(meta[,c("Site_ID", "Protection")], Site_biodiv)
Site_biodiv%>%
filter(is.na(Site))
# add cyclone information
Site_biodiv <- Site_biodiv %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2023")  ~ "Post-cyclone"))
Site_biodiv$cyclone <- as.factor(Site_biodiv$cyclone)
Site_biodiv$Protection <- as.factor(Site_biodiv$Protection)
Benthic_cover <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/2 - Raw_data/2 - CSV/percent_covers.csv", sep=",")
View(Benthic_cover)
Benthic_cover <- Benthic_cover[-nrow(Benthic_cover),]
View(Benthic_cover)
Benthic_cover$Site_ID <- sub("_T.*", "",Benthic_cover$Image.name)
Benthic_cover$Site_ID <- gsub("_", "-", Benthic_cover$Site_ID)
names(Benthic_cover) <- gsub("\\.", " ", names(Benthic_cover))
# Correct site names
Benthic_cover$Site_ID <- gsub("2019-Fishbowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FishBowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FrenchmanReef", "2019-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef- T2P1000873.JPG", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef Reef", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-MikesMaze", "2019-Mikes Maze", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Mike'sMaze", "2019-Mikes Maze", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-FrenchmanReef", "2023-Frenchman Reef", Benthic_cover$Site_ID)
unique(Benthic_cover$Site_ID)
Benthic_cover <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/2 - Raw_data/2 - CSV/percent_covers.csv", sep=",")
Benthic_cover <- Benthic_cover[-nrow(Benthic_cover),]
Benthic_cover$Site_ID <- sub("_T.*", "",Benthic_cover$Image.name)
Benthic_cover$Site_ID <- gsub("_", "-", Benthic_cover$Site_ID)
names(Benthic_cover) <- gsub("\\.", " ", names(Benthic_cover))
# Correct site names
Benthic_cover$Site_ID <- gsub("2019-Fishbowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FishBowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FrenchmanReef", "2019-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef- T2P1000873.JPG", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef Reef", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-MikesMaze", "2019-Mikes Maze", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Mike'sMaze", "2019-Mikes Maze", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-SharkHotel", "2019-Shark Hotel", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2020-Proselyte", "2020-Proselyte Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-LongBayReef", "2023-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-FrenchmanReef", "2023-Frenchman Reef", Benthic_cover$Site_ID)
unique(Benthic_cover$Site_ID)
Benthic_cover_site2 <- Benthic_cover[,c(113,5:112)]
# Compute cover per site
Benthic_cover_site2 <- Benthic_cover_site2 %>%
group_by(Site_ID)%>%
summarise_all(funs(mean))
# Correct names to match with CPCe
colnames(Benthic_cover_site2) <- gsub(" spp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Coral Juvenile","Coral juvenile", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub(" sp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("CCA  crustose coralline algae ","Coralline algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turf algae","Turf", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turbinaria  algae ","Turbinaria", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead Gorgonian","Dead gorgonian", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead coral algae","Dead coral with algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("other disease","Other disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("white band disease","White Band Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("White Plague  type II","Plague, Type II", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Old dead coral  encrusting ","Old dead coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Diseased Coral","Diseased coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Yellow band disease","Yellow Blotch Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Other like" ,"OTHER LIVE" , colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastraea faveolata","Orbicella faveolata", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastrea cavernosa","Montastraea cavernosa", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Mycetophyllia lamarckana","Mycetophyllia lamarckiana", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Stephanocoenia michellini","Stephanocoenia intersepta", colnames(Benthic_cover_site2))
# Add column from CPCe missing in CoralNet
Benthic_cover_site2$Peyssonnelid <- 0
Benthic_cover_site2$Cyanobacteria <- 0
Benthic_cover_site2$Tunicate <- 0
# Remove unwanted columns
Benthic_cover_site2 <- Benthic_cover_site2 %>%
select(-c(Shadow, TAPE, Wand, `Diploria stigosa`))
# Remove unwanted columns
Benthic_cover_site2 <- Benthic_cover_site2 %>%
dplyr::select(-c(Shadow, TAPE, Wand, `Diploria stigosa`))
View(Benthic_cover_site2)
# Compute general categories as with CPCe
Benthic_cover_site2$CORAL <- rowSums(Benthic_cover_site2[,c(2:21,23:40,42:47,49:56,64:66)])
Benthic_cover_site2$`DISEASED CORALS` <- rowSums(Benthic_cover_site2[,c(22,81,83,88:90)])
Benthic_cover_site2$`CORALLINE ALGAE` <- rowSums(Benthic_cover_site2[,92])
Benthic_cover_site2$`DEAD CORAL WITH ALGAE` <- rowSums(Benthic_cover_site2[,c(41,48,59,78)])
Benthic_cover_site2$SPONGES <- rowSums(Benthic_cover_site2[,75])
Benthic_cover_site2$ZOANTHIDS <- rowSums(Benthic_cover_site2[,c(69,76)])
Benthic_cover_site2$`SAND, PAVEMENT, RUBBLE` <- rowSums(Benthic_cover_site2[,c(77,79,85)])
Benthic_cover_site2$GORGONIANS <- rowSums(Benthic_cover_site2[,c(58,60:63,67,68,70:74)])
Benthic_cover_site2$MACROALGAE <- rowSums(Benthic_cover_site2[,c(91,93:106)])
Benthic_cover_site2$`OTHER LIVE` <- rowSums(Benthic_cover_site2[,c(57,80,82,84,107,108)])
Benthic_cover_site2$UNKNOWNS <- rowSums(Benthic_cover_site2[,87])
# Compute number of frames per site
unique_site <- unique(Benthic_cover_site2$Site_ID)
for (i in 1:length(unique_site)) {
df <- Benthic_cover %>%
filter(Site_ID==unique_site[[i]])
Benthic_cover_site2[i,"Number of frames"] <- nrow(df)
}
# load CPCe data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_CPCe.rdata")
# Add columns from CoralNet missing in CPCe
Benthic_cover_site$`Agaricia humilis` <- 0
Benthic_cover_site$Rhodophyta <- 0
Benthic_cover_site <- Benthic_cover_site %>%
select(-c("Halophylla"))
Benthic_cover_site <- Benthic_cover_site %>%
dplyr::select(-c("Halophylla"))
# Check if all names match
names_CoralNet <- names(Benthic_cover_site2[,-1])
names_CPCe <- names(Benthic_cover_site[,-1])
common_names <- intersect(names_CoralNet, names_CPCe)
# Reorder columns and assemble both dataframes
Benthic_cover_site2 <- Benthic_cover_site2[,names(Benthic_cover_site)]
Benthic_cover_site_all <- rbind(Benthic_cover_site, Benthic_cover_site2)
save(Benthic_cover_site_all, file="c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
View(Benthic_cover_site_all)
View(meta)
Benthic_cover <- left_join(meta[,c("Site_ID", "Protection", "Year")], Benthic_cover_site_all)
Benthic_cover$Year <- as.factor(Benthic_cover$Year)
# add cyclone information
Benthic_cover <- Benthic_cover %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2023")  ~ "Post-cyclone"))
View(Benthic_cover)
View(Benthic_cover_site_all)
View(meta)
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Site_biodiversity_metrics.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Site_biodiv$Year <- as.factor(Site_biodiv$Year)
Site_biodiv <- left_join(meta[,c("Site_ID", "Protection")], Site_biodiv)
View(Site_biodiv)
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Site_biodiversity_metrics.rdata")
View(Site_biodiv)
# Load fish data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Site_biodiversity_metrics.rdata")
View(Site_biodiv)
Benthic_cover <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/2 - Raw_data/2 - CSV/percent_covers.csv", sep=",")
Benthic_cover <- Benthic_cover[-nrow(Benthic_cover),]
Benthic_cover$Site_ID <- sub("_T.*", "",Benthic_cover$Image.name)
Benthic_cover$Site_ID <- gsub("_", "-", Benthic_cover$Site_ID)
names(Benthic_cover) <- gsub("\\.", " ", names(Benthic_cover))
# Correct site names
Benthic_cover$Site_ID <- gsub("2018-Mikes Maze", "2018-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Fishbowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FishBowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FrenchmanReef", "2019-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef- T2P1000873.JPG", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef Reef", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-MikesMaze", "2019-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Mike'sMaze", "2019-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-SharkHotel", "2019-Shark Hotel", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2020-Proselyte", "2020-Proselyte Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2020-Mikes Maze", "2020-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-LongBayReef", "2023-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-FrenchmanReef", "2023-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-Mikes Maze", "2023-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover_site2 <- Benthic_cover[,c(113,5:112)]
# Compute cover per site
Benthic_cover_site2 <- Benthic_cover_site2 %>%
group_by(Site_ID)%>%
summarise_all(funs(mean))
# Correct names to match with CPCe
colnames(Benthic_cover_site2) <- gsub(" spp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Coral Juvenile","Coral juvenile", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub(" sp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("CCA  crustose coralline algae ","Coralline algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turf algae","Turf", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turbinaria  algae ","Turbinaria", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead Gorgonian","Dead gorgonian", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead coral algae","Dead coral with algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("other disease","Other disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("white band disease","White Band Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("White Plague  type II","Plague, Type II", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Old dead coral  encrusting ","Old dead coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Diseased Coral","Diseased coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Yellow band disease","Yellow Blotch Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Other like" ,"OTHER LIVE" , colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastraea faveolata","Orbicella faveolata", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastrea cavernosa","Montastraea cavernosa", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Mycetophyllia lamarckana","Mycetophyllia lamarckiana", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Stephanocoenia michellini","Stephanocoenia intersepta", colnames(Benthic_cover_site2))
# Add column from CPCe missing in CoralNet
Benthic_cover_site2$Peyssonnelid <- 0
Benthic_cover_site2$Cyanobacteria <- 0
Benthic_cover_site2$Tunicate <- 0
# Remove unwanted columns
Benthic_cover_site2 <- Benthic_cover_site2 %>%
dplyr::select(-c(Shadow, TAPE, Wand, `Diploria stigosa`))
# Compute general categories as with CPCe
Benthic_cover_site2$CORAL <- rowSums(Benthic_cover_site2[,c(2:21,23:40,42:47,49:56,64:66)])
Benthic_cover_site2$`DISEASED CORALS` <- rowSums(Benthic_cover_site2[,c(22,81,83,88:90)])
Benthic_cover_site2$`CORALLINE ALGAE` <- rowSums(Benthic_cover_site2[,92])
Benthic_cover_site2$`DEAD CORAL WITH ALGAE` <- rowSums(Benthic_cover_site2[,c(41,48,59,78)])
Benthic_cover_site2$SPONGES <- rowSums(Benthic_cover_site2[,75])
Benthic_cover_site2$ZOANTHIDS <- rowSums(Benthic_cover_site2[,c(69,76)])
Benthic_cover_site2$`SAND, PAVEMENT, RUBBLE` <- rowSums(Benthic_cover_site2[,c(77,79,85)])
Benthic_cover_site2$GORGONIANS <- rowSums(Benthic_cover_site2[,c(58,60:63,67,68,70:74)])
Benthic_cover_site2$MACROALGAE <- rowSums(Benthic_cover_site2[,c(91,93:106)])
Benthic_cover_site2$`OTHER LIVE` <- rowSums(Benthic_cover_site2[,c(57,80,82,84,107,108)])
Benthic_cover_site2$UNKNOWNS <- rowSums(Benthic_cover_site2[,87])
# Compute number of frames per site
unique_site <- unique(Benthic_cover_site2$Site_ID)
for (i in 1:length(unique_site)) {
df <- Benthic_cover %>%
filter(Site_ID==unique_site[[i]])
Benthic_cover_site2[i,"Number of frames"] <- nrow(df)
}
# load CPCe data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_CPCe.rdata")
# Add columns from CoralNet missing in CPCe
Benthic_cover_site$`Agaricia humilis` <- 0
Benthic_cover_site$Rhodophyta <- 0
Benthic_cover_site <- Benthic_cover_site %>%
dplyr::select(-c("Halophylla"))
unique(Benthic_cover_site$Site_ID)
Benthic_cover_site$Site_ID <- gsub("PRE 2017-Proselyte Reef", "2017_pre-Proselyte Reef", Benthic_cover_site$Site_ID)
# Check if all names match
names_CoralNet <- names(Benthic_cover_site2[,-1])
names_CPCe <- names(Benthic_cover_site[,-1])
common_names <- intersect(names_CoralNet, names_CPCe)
# Reorder columns and assemble both dataframes
Benthic_cover_site2 <- Benthic_cover_site2[,names(Benthic_cover_site)]
Benthic_cover_site_all <- rbind(Benthic_cover_site, Benthic_cover_site2)
save(Benthic_cover_site_all, file="c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Benthic_cover <- left_join(meta[,c("Site_ID", "Protection", "Year")], Benthic_cover_site_all)
View(Benthic_cover)
View(Benthic_cover_site_all)
Benthic_cover <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/2 - Raw_data/2 - CSV/percent_covers.csv", sep=",")
Benthic_cover <- Benthic_cover[-nrow(Benthic_cover),]
Benthic_cover$Site_ID <- sub("_T.*", "",Benthic_cover$Image.name)
Benthic_cover$Site_ID <- gsub("_", "-", Benthic_cover$Site_ID)
names(Benthic_cover) <- gsub("\\.", " ", names(Benthic_cover))
unique(Benthic_cover$Site_ID)
# Correct site names
Benthic_cover$Site_ID <- gsub("2018-Mikes Maze", "2018-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Fishbowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FishBowl", "2019-Fish Bowl", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-FrenchmanReef", "2019-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef- T2P1000873.JPG", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Long Bay Reef Reef", "2019-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Mikes Maze", "2019-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-MikesMaze", "2019-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-Mike'sMaze", "2019-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2019-SharkHotel", "2019-Shark Hotel", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2020-Proselyte", "2020-Proselyte Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2020-Mikes Maze", "2020-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-LongBayReef", "2023-Long Bay Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-FrenchmanReef", "2023-Frenchman Reef", Benthic_cover$Site_ID)
Benthic_cover$Site_ID <- gsub("2023-Mikes Maze", "2023-Mikes Mazes", Benthic_cover$Site_ID)
Benthic_cover_site2 <- Benthic_cover[,c(113,5:112)]
# Compute cover per site
Benthic_cover_site2 <- Benthic_cover_site2 %>%
group_by(Site_ID)%>%
summarise_all(funs(mean))
# Correct names to match with CPCe
colnames(Benthic_cover_site2) <- gsub(" spp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Coral Juvenile","Coral juvenile", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub(" sp ","", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("CCA  crustose coralline algae ","Coralline algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turf algae","Turf", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Turbinaria  algae ","Turbinaria", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead Gorgonian","Dead gorgonian", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Dead coral algae","Dead coral with algae", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("other disease","Other disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("white band disease","White Band Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("White Plague  type II","Plague, Type II", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Old dead coral  encrusting ","Old dead coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Diseased Coral","Diseased coral", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Yellow band disease","Yellow Blotch Disease", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Other like" ,"OTHER LIVE" , colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastraea faveolata","Orbicella faveolata", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Montastrea cavernosa","Montastraea cavernosa", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Mycetophyllia lamarckana","Mycetophyllia lamarckiana", colnames(Benthic_cover_site2))
colnames(Benthic_cover_site2) <- gsub("Stephanocoenia michellini","Stephanocoenia intersepta", colnames(Benthic_cover_site2))
# Add column from CPCe missing in CoralNet
Benthic_cover_site2$Peyssonnelid <- 0
Benthic_cover_site2$Cyanobacteria <- 0
Benthic_cover_site2$Tunicate <- 0
# Remove unwanted columns
Benthic_cover_site2 <- Benthic_cover_site2 %>%
dplyr::select(-c(Shadow, TAPE, Wand, `Diploria stigosa`))
# Compute general categories as with CPCe
Benthic_cover_site2$CORAL <- rowSums(Benthic_cover_site2[,c(2:21,23:40,42:47,49:56,64:66)])
Benthic_cover_site2$`DISEASED CORALS` <- rowSums(Benthic_cover_site2[,c(22,81,83,88:90)])
Benthic_cover_site2$`CORALLINE ALGAE` <- rowSums(Benthic_cover_site2[,92])
Benthic_cover_site2$`DEAD CORAL WITH ALGAE` <- rowSums(Benthic_cover_site2[,c(41,48,59,78)])
Benthic_cover_site2$SPONGES <- rowSums(Benthic_cover_site2[,75])
Benthic_cover_site2$ZOANTHIDS <- rowSums(Benthic_cover_site2[,c(69,76)])
Benthic_cover_site2$`SAND, PAVEMENT, RUBBLE` <- rowSums(Benthic_cover_site2[,c(77,79,85)])
Benthic_cover_site2$GORGONIANS <- rowSums(Benthic_cover_site2[,c(58,60:63,67,68,70:74)])
Benthic_cover_site2$MACROALGAE <- rowSums(Benthic_cover_site2[,c(91,93:106)])
Benthic_cover_site2$`OTHER LIVE` <- rowSums(Benthic_cover_site2[,c(57,80,82,84,107,108)])
Benthic_cover_site2$UNKNOWNS <- rowSums(Benthic_cover_site2[,87])
# Compute number of frames per site
unique_site <- unique(Benthic_cover_site2$Site_ID)
for (i in 1:length(unique_site)) {
df <- Benthic_cover %>%
filter(Site_ID==unique_site[[i]])
Benthic_cover_site2[i,"Number of frames"] <- nrow(df)
}
# load CPCe data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_CPCe.rdata")
# Add columns from CoralNet missing in CPCe
Benthic_cover_site$`Agaricia humilis` <- 0
Benthic_cover_site$Rhodophyta <- 0
Benthic_cover_site <- Benthic_cover_site %>%
dplyr::select(-c("Halophylla"))
Benthic_cover_site$Site_ID <- gsub("PRE 2017-Proselyte Reef", "2017_pre-Proselyte Reef", Benthic_cover_site$Site_ID)
# Check if all names match
names_CoralNet <- names(Benthic_cover_site2[,-1])
names_CPCe <- names(Benthic_cover_site[,-1])
common_names <- intersect(names_CoralNet, names_CPCe)
# Reorder columns and assemble both dataframes
Benthic_cover_site2 <- Benthic_cover_site2[,names(Benthic_cover_site)]
Benthic_cover_site_all <- rbind(Benthic_cover_site, Benthic_cover_site2)
save(Benthic_cover_site_all, file="c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Benthic_cover <- left_join(meta[,c("Site_ID", "Protection", "Year")], Benthic_cover_site_all)
View(Benthic_cover)
Benthic_cover$Year <- as.factor(Benthic_cover$Year)
# add cyclone information
Benthic_cover <- Benthic_cover %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2023")  ~ "Post-cyclone"))
# load bleaching / disease data
bleach_disease <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Bleaching_Disease.csv", sep = ",", na.strings = "")
# load bleaching / disease data
bleach_disease <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Bleaching_Disease.csv", sep = ";", na.strings = "")
Benthic_cover <- left_join(Benthic_cover, bleach_disease)
Benthic_cover$Bleaching_frequency <- Benthic_cover$Number_frames_bleaching/Benthic_cover$`Number of frames`
Benthic_cover$Disease_frequency <- Benthic_cover$Number_frames_disease/Benthic_cover$`Number of frames`
View(Benthic_cover)
# keep only important columns
Cover <- Benthic_cover[,c(1:3,122,5:15,125,126)]
View(Cover)
# Load data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Benthic_cover <- left_join(meta[,c("Site_ID", "Protection", "Year", "Site")], Benthic_cover_site_all)
Benthic_cover$Year <- as.factor(Benthic_cover$Year)
# add cyclone information
Benthic_cover <- Benthic_cover %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2023")  ~ "Post-cyclone"))
Benthic_cover <- left_join(Benthic_cover, bleach_disease)
Benthic_cover$Bleaching_frequency <- Benthic_cover$Number_frames_bleaching/Benthic_cover$`Number of frames`
Benthic_cover$Disease_frequency <- Benthic_cover$Number_frames_disease/Benthic_cover$`Number of frames`
# keep only important columns
Cover <- Benthic_cover[,c(1:3,122,5:15,125,126)]
View(Benthic_cover)
# keep only important columns
Cover <- Benthic_cover[,c(1:4,123,6:16,126,127)]
df <- Cover[,c(3,4,6:16)]
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Famyly_abundance.rdata")
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Family_abundance.rdata")
View(Fish_family_abund_site)
df <- Cover[,c(1,6:16)]
library(reshape2)
df <- melt(df)
View(df)
df <- left_join(df, Cover[,c("Site_ID","Year","Site")])
View(df)
# plot mean Fish family proportion per year
ggplot(df, aes(x=Year,fill=variable))+
geom_bar(position="fill")+
labs(x="", y="Cover percentage")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
families <- c("Acanthuridae", "Labridae", "Lutjanidae", "Serranidae", "Epinephelidae", "Carcharhinidae", "Dasyatidae", "Scaridae")
# Load fish data
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Site_biodiversity_metrics.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep = ",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Site_biodiv$Year <- as.factor(Site_biodiv$Year)
Site_biodiv <- left_join(meta[,c("Site_ID", "Protection", "Fish_observer")], Site_biodiv)
Fish_family_abund_site <- left_join(Fish_family_abund_site, Site_biodiv[,c("Year","Site_ID", "Site")])
Fish_family_abund_site <- Fish_family_abund_site%>%
filter(Family%in%families)%>%
filter(!is.na(Site))
# plot mean Fish family proportion per year
ggplot(Fish_family_abund_site, aes(x=Year,fill=Family))+
geom_bar(position="fill")+
labs(x="", y="Family proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2023"))+
theme_bw()
# plot mean Fish family proportion per year
ggplot(df, aes(x=Year,fill=variable, y=value))+
geom_bar(position="fill")+
labs(x="", y="Cover percentage")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
# plot mean Fish family proportion per year
ggplot(df, aes(x=Year,fill=variable, y=value))+
geom_bar(position="fill", stat = "identity")+
labs(x="", y="Cover percentage")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
View(Fish_family_abund_site)
# plot mean Fish family proportion per year
ggplot(Fish_family_abund_site, aes(x=Year,fill=Family,y=Number))+
geom_bar(position="fill",stat="identity")+
labs(x="", y="Family proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2023"))+
theme_bw()
# plot mean Fish family proportion per year
ggplot(Fish_family_abund_site, aes(x=Year,fill=Family,y=Number))+
geom_bar(position="fill",stat="identity")+
labs(x="", y="Family proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Trophic_abundance.rdata")
Trophic_abund <- left_join(Trophic_abund, Site_biodiv[,c("Year","Site_ID", "Site")])
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Trophic_abundance.rdata")
View(Fish_trophic_abund_site)
Fish_family_abund_site <- left_join(Fish_family_abund_site, Site_biodiv[,c("Year","Site_ID", "Site")])
Fish_family_abund_site <- Fish_family_abund_site%>%
filter(!is.na(Site))
Fish_family_abund_site$Site <- as.factor(Fish_family_abund_site$Site)
# plot mean Fish family proportion per year
ggplot(Fish_family_abund_site, aes(x=Year,fill=trophic_group,y=Number))+
geom_bar(position="fill",stat="identity")+
labs(x="", y="Trophic group proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2023"))+
theme_bw()
View(Fish_trophic_abund_site)
View(Fish_trophic_abund_site)
load("c://Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Trophic_abundance.rdata")
Fish_trophic_abund_site <- left_join(Fish_trophic_abund_site, Site_biodiv[,c("Year","Site_ID", "Site")])
Fish_trophic_abund_site <- Fish_trophic_abund_site%>%
filter(!is.na(Site))
Fish_trophic_abund_site$Site <- as.factor(Fish_trophic_abund_site$Site)
# plot mean Fish family proportion per year
ggplot(Fish_trophic_abund_site, aes(x=Year,fill=trophic_group,y=Number))+
geom_bar(position="fill",stat="identity")+
labs(x="", y="Trophic group proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2023"))+
theme_bw()
# plot mean Fish family proportion per year
ggplot(Fish_trophic_abund_site, aes(x=Year,fill=trophic_group,y=Number))+
geom_bar(position="fill",stat="identity")+
labs(x="", y="Trophic group proportion")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
# plot mean Fish family proportion per year
ggplot(df, aes(x=Year,fill=variable, y=value))+
geom_bar(position="fill", stat = "identity")+
labs(x="", y="Cover percentage")+
facet_wrap(~Site)+
scale_x_discrete(limits=c("2016", "2017_pre", "2017_post", "2018", "2019","2020","2021","2022","2023"))+
theme_bw()
View(meta)
