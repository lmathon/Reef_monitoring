summary(GAM2)
GAM2 = gam(Piscivorous_Abundance ~ Year+Site+Protection+dist_to_coast+s(DHW)+CORAL+SST, data=myData)
summary(GAM2)
GAM2 = gam(Piscivorous_Abundance ~ Year+Site+Protection+s(dist_to_coast)+s(DHW)+CORAL+SST, data=myData)
GAM2 = gam(Piscivorous_Abundance ~ Year+Site+Protection+dist_to_coast+s(DHW)+s(CORAL)+SST, data=myData)
summary(GAM2)
GAM2 = gam(Piscivorous_Abundance ~ Year+Site+Protection+dist_to_coast+s(DHW)+s(CORAL)+s(SST), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM1 = gam(Bleaching_frequency ~ CORAL+Year+SST+DHW, data=myData)
summary(GAM1)
gratia::draw(GAM1, residuals=F, nrow=1)
GAM1 = gam(Bleaching_frequency ~ CORAL+Year+s(SST)+s(DHW), data=myData)
summary(GAM1)
gratia::draw(GAM1, residuals=F, nrow=1)
GAM1 = gam(Bleaching_frequency ~ s(CORAL)+Year+s(SST)+s(DHW), data=myData)
summary(GAM1)
gratia::draw(GAM1, residuals=F, nrow=1)
GAM1 = gam(Bleaching_frequency ~ s(CORAL)+s(SST)+s(DHW), data=myData)
summary(GAM1)
gratia::draw(GAM1, residuals=F, nrow=1)
GAM1 = gam(Bleaching_frequency ~ s(CORAL)+s(DHW), data=myData)
summary(GAM1)
gratia::draw(GAM1, residuals=F, nrow=1)
ggsave("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Outputs/GAM/Bleaching/GAM_Bleaching_frequency.png")
GAM1 = gam(Scaridae_Biomass ~ Year+SST+Protection+Fish_density+Site+Bleaching_frequency+Disease_frequency+DHW+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density+CORAL, data=myData)
summary(GAM1)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Protection+Fish_density+Site+Bleaching_frequency+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density+CORAL, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Protection+Site+Bleaching_frequency+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density+CORAL, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Protection+Site+Bleaching_frequency+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Protection+Bleaching_frequency+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Bleaching_frequency+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+Disease_frequency+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
dist_to_coast+MACROALGAE+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
dist_to_coast+s(MACROALGAE)+Recruits_density, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+
s(dist_to_coast)+s(MACROALGAE)+s(Recruits_density), data=myData)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
s(dist_to_coast)+s(MACROALGAE)+s(Recruits_density), data=myData)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+GORGONIANS+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
dist_to_coast+s(MACROALGAE), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
s(MACROALGAE), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
s(dist_to_coast)+s(MACROALGAE), data=myData)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+
s(dist_to_coast)+s(MACROALGAE), data=myData)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+s(GORGONIANS)+
dist_to_coast+s(MACROALGAE), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+s(SST)+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Biomass ~ Year+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Biomass ~ Year+SST+
dist_to_coast+s(MACROALGAE)+s(Recruits_density), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
gratia::draw(GAM2, residuals=F, nrow=2)
gratia::draw(GAM2, residuals=F, nrow=1)
GAM1 = gam(Scaridae_Abundance ~ Year+SST+Protection+Fish_density+Site+Bleaching_frequency+Disease_frequency+DHW+
dist_to_coast+GORGONIANS+MACROALGAE+Recruits_density+CORAL, data=myData)
summary(GAM1)
GAM2 = gam(Scaridae_Abundance ~ Year+Protection+GORGONIANS+MACROALGAE+CORAL+
Bleaching_frequency+SST, data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Abundance ~ Year+GORGONIANS+MACROALGAE+CORAL+
Bleaching_frequency+SST, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Abundance ~ Year+s(GORGONIANS)+s(MACROALGAE)+s(CORAL)+
Bleaching_frequency+SST, data=myData)
summary(GAM2)
GAM2 = gam(Scaridae_Abundance ~ Year+s(GORGONIANS)+s(MACROALGAE)+s(CORAL)+
s(Bleaching_frequency)+s(SST), data=myData)
GAM2 = gam(Scaridae_Abundance ~ Year+s(GORGONIANS)+s(MACROALGAE)+s(CORAL)+
s(Bleaching_frequency)+SST, data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Abundance ~ Year+s(GORGONIANS)+s(MACROALGAE)+
s(Bleaching_frequency)+SST, data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
GAM2 = gam(Scaridae_Abundance ~ Year+s(GORGONIANS)+s(MACROALGAE)+
s(Bleaching_frequency)+s(SST), data=myData)
summary(GAM2)
gratia::draw(GAM2, residuals=F, nrow=2, parametric=T)
gratia::draw(GAM2, residuals=F, nrow=2)
ggsave("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Outputs/GAM/Scaridae_abundance/GAM_Scaridae_abundance.png")
library(vegan)
library(tidyverse)
library(pairwiseAdonis)
load("C:/Users/mathonlocal/Desktop/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
load("C:/Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Benthic_cover_site_all.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Benthic_cover_site_all <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude","Year","Site")], Benthic_cover_site_all)
Benthic_cover_site_all$Year <- as.factor(Benthic_cover_site_all$Year)
Benthic_cover_site_all <- Benthic_cover_site_all %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
Benthic_cover_site_all <- Benthic_cover_site_all %>%
filter(!is.na(CORAL))
cover_matrix <- Benthic_cover_site_all[,c(19:124)]
dist_matrix <- vegdist(cover_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Benthic_cover_site_all, permutations = 999)
perm_sp # Significant Year effect
pair.mod<-pairwise.adonis(dist_matrix,factors=Benthic_cover_site_all$Year)
pair.mod # 2016 is different
library(tidyverse)
library(raster)
library(tools)
library(sf)
library(rgdal)
library(rgeos)
pair.mod<-pairwise.adonis(dist_matrix,factors=Benthic_cover_site_all$Year)
pair.mod # 2016 is different
perm_sp # Significant Year effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Benthic_cover_site_all, permutations = 999)
perm_sp # Significant site effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Benthic_cover_site_all, permutations = 999)
perm_sp # Significant protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Benthic_cover_site_all, permutations = 999)
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Benthic_cover_site_all, permutations = 999)
perm_sp # Significant Cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Benthic_cover_site_all, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, and their interaction
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_family_abund_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
Fish_family_abund_site$Year <- as.factor(Fish_family_abund_site$Year)
Fish_family_abund_site <- Fish_family_abund_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_family_abund_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude")], Fish_family_abund_site)
Fish_family_abund_site$Protection <- as.factor(Fish_family_abund_site$Protection)
Fish_family_abund_site$cyclone <- as.factor(Fish_family_abund_site$cyclone)
Fish_family_abund_site$Site <- as.factor(Fish_family_abund_site$Site)
Fish_family_abund_site <- Fish_family_abund_site %>%
filter(!is.na(Acanthuridae))
fam_matrix <- Fish_family_abund_site[,c(5:38)]
dist_matrix <- vegdist(fam_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant Year effect
pair.mod<-pairwise.adonis(dist_matrix,factors=Fish_family_abund_site$Year)
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_family_abund_site, permutations = 999)
perm_sp # No site effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant Cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_family_abund_site, permutations = 999)
perm_sp # Significant effect of Year and Protection nested in Year
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_family_biomass_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
Fish_family_biomass_site$Year <- as.factor(Fish_family_biomass_site$Year)
Fish_family_biomass_site <- Fish_family_biomass_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_family_biomass_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude")], Fish_family_biomass_site)
Fish_family_biomass_site$Protection <- as.factor(Fish_family_biomass_site$Protection)
Fish_family_biomass_site$cyclone <- as.factor(Fish_family_biomass_site$cyclone)
Fish_family_biomass_site$Site <- as.factor(Fish_family_biomass_site$Site)
Fish_family_biomass_site <- Fish_family_biomass_site %>%
filter(!is.na(Acanthuridae))
fam_matrix <- Fish_family_biomass_site[,c(5:34)]
dist_matrix <- vegdist(fam_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_family_biomass_site, permutations = 999)
perm_sp # Significant effect of Year
pair.mod<-pairwise.adonis(dist_matrix,factors=Fish_family_biomass_site$Year)
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_family_biomass_site, permutations = 999)
perm_sp # significant effect of Site
pair.mod<-pairwise.adonis(dist_matrix,factors=Fish_family_biomass_site$Site)
pair.mod # Shark Hotel different than Moonscape
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_family_biomass_site, permutations = 999)
perm_sp # significant effect of Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_family_biomass_site, permutations = 999)
perm_sp # significant effect of Cyclone
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_family_biomass_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_family_biomass_site, permutations = 999)
perm_sp #  Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_family_biomass_site, permutations = 999)
perm_sp #  Significant effect of Year and Protection nested in Year
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_species_abund_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
Fish_species_abund_site$Year <- as.factor(Fish_species_abund_site$Year)
Fish_species_abund_site <- Fish_species_abund_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_species_abund_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude")], Fish_species_abund_site)
rownames(Fish_species_abund_site) <- Fish_species_abund_site$Site_ID
Fish_species_abund_site$Protection <- as.factor(Fish_species_abund_site$Protection)
Fish_species_abund_site$cyclone <- as.factor(Fish_species_abund_site$cyclone)
Fish_species_abund_site$Site <- as.factor(Fish_species_abund_site$Site)
Fish_species_abund_site <- Fish_species_abund_site %>%
filter(!is.na(`Abudefduf saxatilis`))
sp_matrix <- Fish_species_abund_site[,c(5:102)]
dist_matrix <- vegdist(sp_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_species_abund_site, permutations = 999)
perm_sp # Significant Year effect
pair.mod<-pairwise.adonis(sp_matrix,factors=Fish_species_abund_site$Year)
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_species_abund_site, permutations = 999)
perm_sp # No site effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_species_abund_site, permutations = 999)
perm_sp # No Protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_species_abund_site, permutations = 999)
perm_sp # Significant Cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_species_abund_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_species_abund_site, permutations = 999)
perm_sp #  Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_species_abund_site, permutations = 999)
perm_sp #  Significant effect of Year
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_species_biomass_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
#-------------------------------------------------------------------------------------------
## Prepare Fish species assemblage
#-------------------------------------------------------------------------------------------
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_species_biomass_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude", "Site","Year")], Fish_species_biomass_site)
rownames(Fish_species_biomass_site) <- Fish_species_biomass_site$Site_ID
Fish_species_biomass_site$Year <- as.factor(Fish_species_biomass_site$Year)
Fish_species_biomass_site <- Fish_species_biomass_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
Fish_species_biomass_site$Protection <- as.factor(Fish_species_biomass_site$Protection)
Fish_species_biomass_site$cyclone <- as.factor(Fish_species_biomass_site$cyclone)
Fish_species_biomass_site$Site <- as.factor(Fish_species_biomass_site$Site)
Fish_species_biomass_site <- Fish_species_biomass_site %>%
filter(!is.na(`Abudefduf saxatilis`))
sp_matrix <- Fish_species_biomass_site[,c(7:89)]
dist_matrix <- vegdist(sp_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant Year effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_species_biomass_site, permutations = 999)
perm_sp # small effect of site
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant Cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_species_biomass_site, permutations = 999)
perm_sp # Significant effect of Year and Protection nested in Year
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_trophic_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_trophic_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude","Year","Site")], Fish_trophic_site)
Fish_trophic_site$Year <- as.factor(Fish_trophic_site$Year)
Fish_trophic_site <- Fish_trophic_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
Fish_trophic_site$Protection <- as.factor(Fish_trophic_site$Protection)
Fish_trophic_site$cyclone <- as.factor(Fish_trophic_site$cyclone)
Fish_trophic_site$Site <- as.factor(Fish_trophic_site$Site)
Fish_trophic_site <- Fish_trophic_site %>%
filter(!is.na(Herbivorous_Density))
troph_matrix <- Fish_trophic_site[,c(11:14)]
dist_matrix <- vegdist(troph_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant Year effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_trophic_site, permutations = 999)
perm_sp # No site effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # No Protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant Cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year and Protection nested in Year
load("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/3 - Clean_data/Fish_trophic_site.rdata")
meta <- read.csv("c://Users/mathonlocal/Desktop/Nature Foundation/CORENA Project/Reef_Monitoring/Data/1 - Metadata/GCRMN_metadata.csv", sep=",", na.strings = "NA")
meta$Protection[is.na(meta$Protection)] <- "Unprotected"
Fish_trophic_site <- left_join(meta[,c("Site_ID","Protection","Latitude","Longitude","Year","Site")], Fish_trophic_site)
Fish_trophic_site$Year <- as.factor(Fish_trophic_site$Year)
Fish_trophic_site <- Fish_trophic_site %>%
mutate(cyclone = case_when(
Year%in%c("2016", "2017_pre") ~ "Pre-cyclone",
Year%in%c("2017_post", "2018","2019","2020","2021","2022","2023")  ~ "Post-cyclone"))
Fish_trophic_site$Protection <- as.factor(Fish_trophic_site$Protection)
Fish_trophic_site$cyclone <- as.factor(Fish_trophic_site$cyclone)
Fish_trophic_site$Site <- as.factor(Fish_trophic_site$Site)
Fish_trophic_site <- Fish_trophic_site %>%
filter(!is.na(Herbivorous_Density))
troph_matrix <- Fish_trophic_site[,c(15:18)]
dist_matrix <- vegdist(troph_matrix, method = "bray")
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant Year effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Site
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Site, data = Fish_trophic_site, permutations = 999)
perm_sp # No site effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant protection effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Cyclone
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant cyclone effect
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year*cyclone*Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ cyclone*Year*Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year, cyclone and protection, but not their interaction
#--------------------------------------------------------------------------------
## PERMANOVA ~ Protection/Year
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Protection/Year, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year and Year nested in Protection
#--------------------------------------------------------------------------------
## PERMANOVA ~ Year/Protection
#--------------------------------------------------------------------------------
perm_sp=adonis2(dist_matrix ~ Year/Protection, data = Fish_trophic_site, permutations = 999)
perm_sp # Significant effect of Year and Protection nested in Year
